"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("graphql"),t=require("@graphql-codegen/visitor-plugin-common"),i=require("dependency-graph");const n={ID:"str",String:"str",Boolean:"bool",Int:"int",Float:"float",AWSDateTime:"datetime"},r=["from"].concat(["copy"]);class s extends t.BaseVisitor{constructor(e,r){throw super(e,{scalars:t.buildScalars(r,{},n)}),this.schema=r,this.addOptionalImport=!1,this.addAnyImport=!1,this.addListImport=!1,this.addUnionImport=!1,this.addEnumImport=!1,this.addFieldImport=!1,this.addDatetimeImport=!1,this.graph=new i.DepGraph({circular:!1}),new Error("haha")}getImports(){throw new Error("haha")}canAddGraphNode(e){return!Object.values(this.scalars).includes(e)&&"Any"!==e}upsertGraphNode(e){this.canAddGraphNode(e)&&!this.graph.hasNode(e)&&this.graph.addNode(e)}addGraphNodeDeps(e,t){this.canAddGraphNode(e)&&(this.upsertGraphNode(e),t.forEach(t=>{this.canAddGraphNode(t)&&(this.upsertGraphNode(t),this.graph.addDependency(e,t))}))}clearOptional(e){return e.startsWith("Optional[")?e.replace(/Optional\[(.*?)\]$/,"$1"):e}Name(e){return e.value}NamedType(e){const{name:t}=e;if(Object.keys(this.scalars).includes(t)){const e=this.scalars[t];return"datetime"===e&&(this.addDatetimeImport=!0),"any"===e?(this.addAnyImport=!0,{id:"Any",source:"Any"}):(this.addOptionalImport=!0,{id:e,source:`Optional[${e}]`})}return this.addOptionalImport=!0,{id:t,source:`Optional["${t}"]`}}ListType(e){this.addListImport=!0,this.addOptionalImport=!0;const{type:t}=e;return{id:t.id,source:`Optional[List[${t.source}]]`}}NonNullType(e){const{type:t}=e;return{id:t.id,source:this.clearOptional(t.source)}}visitFieldOrInputDefinition(e){const i=e.name,{type:n,directives:s}=e;return s.map(e=>e.name).includes("deprecated")?null:r.includes(i)?(this.addFieldImport=!0,{id:n.id,source:t.indent(`${i}_: ${n.source} = Field(None, alias="${i}")`,2)}):{id:n.id,source:t.indent(`${i}: ${n.source}`,2)}}FieldDefinition(e){return this.visitFieldOrInputDefinition(e)}InputValueDefinition(e){return this.visitFieldOrInputDefinition(e)}EnumTypeDefinition(e){this.addEnumImport=!0;const{name:i,values:n}=e,r=`class ${i}(str, Enum):\n${n.map(e=>t.indent(`${e.name} = "${e.name}"`,2)).join("\n")}`;return this.upsertGraphNode(i),{id:i,source:r}}UnionTypeDefinition(e){this.addUnionImport=!0;const{name:t,types:i}=e,n=(null!=i?i:[]).map(e=>this.clearOptional(e.source));return this.addGraphNodeDeps(t,i.map(e=>e.id)),{id:t,source:`${t} = Union[${n.join(", ")}]`}}InterfaceTypeDefinition(e){const{name:t,fields:i}=e,n=i.filter(e=>e),r=`class ${t}(BaseModel):\n${n.map(e=>e.source).join("\n")}`;return this.addGraphNodeDeps(t,n.map(e=>e.id)),{id:t,source:r}}ObjectTypeDefinition(e){const{name:i,fields:n,interfaces:r}=e;n.push({id:"int",source:t.indent("_version: int",2)});const s=n.filter(e=>e),a=r.map(e=>this.clearOptional(e.source).replace(/'/g,"")),o=`class ${i}(${a.length?a.join(", "):"BaseModel"}):\n${s.map(e=>e.source).join("\n")}\n\n${t.indent("def __str__(self):",2)+"\n"+t.indent("return self.value",4)}`;return a.length?this.addGraphNodeDeps(i,a):this.upsertGraphNode(i),{id:i,source:o}}InputObjectTypeDefinition(e){const{name:t,fields:i}=e,n=`class ${t}(BaseModel):\n${i.filter(e=>e).map(e=>e.source).join("\n")}`;return this.upsertGraphNode(t),{id:t,source:n}}Document(e){const{definitions:t}=e;return this.graph.overallOrder().map(e=>{var i;return(null===(i=t.find(t=>t.id===e))||void 0===i?void 0:i.source)||""}).join("\n\n\n")}}exports.plugin=function(t,i,n,r){try{const i=new s(n,t),r=e.printSchema(t),a=e.parse(r),o=e.visit(a,{leave:i}),d=i.getImports();return Promise.resolve(`${d}\n\n\n${o}\n`)}catch(e){return Promise.reject(e)}};
//# sourceMappingURL=graphql-codegen-pydantic.cjs.production.min.js.map
